# 零售推廣目標檢視及派貨系統 - 程式說明文檔

## 目錄
1. [程式概述和主要用途](#程式概述和主要用途)
2. [系統架構和組件說明](#系統架構和組件說明)
3. [詳細的計算邏輯和演算法](#詳細的計算邏輯和演算法)
4. [輸入文件格式和要求](#輸入文件格式和要求)
5. [使用方法和操作流程](#使用方法和操作流程)
6. [輸出結果說明](#輸出結果說明)
7. [配置選項和參數說明](#配置選項和參數說明)
8. [常見問題和故障排除](#常見問題和故障排除)

---

## 程式概述和主要用途

### 系統概述
零售推廣目標檢視及派貨系統是一個專為零售業設計的庫存管理和需求規劃工具。系統基於歷史銷售數據、當前庫存狀況和推廣活動目標，自動計算各門市和產品的需求量，並生成相應的派貨建議。

### 主要用途
- **需求預測**：根據歷史銷售數據和推廣活動預測產品需求
- **庫存管理**：評估現有庫存狀況，識別潛在缺貨風險
- **派貨規劃**：生成各門市的派貨建議，確保推廣活動期間庫存充足
- **報告生成**：提供詳細的計算報告和摘要，便於管理決策

### 核心功能
1. 讀取並整合庫存數據和推廣目標數據
2. 計算日銷售率和基本需求
3. 根據推廣活動計算額外需求
4. 考慮庫存、在途貨品和安全庫存計算淨需求
5. 應用最小訂購量(MOQ)規則生成最終派貨建議
6. 生成多維度報告，包括詳細計算和摘要報告

---

## 系統架構和組件說明

### 系統架構
本系統採用模組化設計，主要包含以下組件：

```
零售推廣目標檢視及派貨系統
├── 核心計算引擎 (promo_calculator.py)
│   ├── 配置管理 (Config)
│   ├── 數據讀取與處理
│   ├── 需求計算
│   └── 報告生成
├── 用戶界面 (streamlit_app.py)
│   ├── 文件上傳
│   ├── 參數配置
│   ├── 結果展示
│   └── 報告下載
└── 依賴庫 (requirements.txt)
    ├── pandas (數據處理)
    ├── streamlit (用戶界面)
    ├── openpyxl (Excel讀寫)
    └── XlsxWriter (Excel輸出)
```

### 主要組件說明

#### 1. 核心計算引擎 (promo_calculator.py)
系統的核心邏輯模組，包含：
- **Config類**：集中管理所有配置參數
- **數據讀取函數**：讀取和驗證輸入文件
- **數據準備函數**：清理和標準化數據
- **數據合併函數**：整合不同來源的數據
- **需求計算函數**：執行核心需求計算邏輯
- **摘要生成函數**：生成匯總報告
- **導出函數**：生成Excel報告

#### 2. 用戶界面 (streamlit_app.py)
基於Streamlit的Web界面，提供：
- 直觀的文件上傳功能
- 交互式參數配置
- 實時計算進度顯示
- 多維度結果展示
- 報告下載功能

#### 3. 配置管理
通過Config類集中管理系統參數，包括：
- 計算常數（如每月天數、預設前置時間）
- 文件列名映射
- 計算規則配置
- 輸出格式設置

---

## 詳細的計算邏輯和演算法

### 計算流程概述
系統按照以下步驟進行需求計算和派貨規劃：

1. **數據準備階段**：
   - 讀取並清理File A（庫存數據）和File B（推廣目標數據）
   - 標準化數據格式和列名
   - 處理缺失值和異常值

2. **數據合併階段**：
   - 將庫存數據與推廣目標數據按Article合併
   - 將合併結果與門市目標百分比按Site合併
   - 識別推廣SKU並標記

3. **需求計算階段**：
   - 計算日銷售率
   - 計算基本需求
   - 計算推廣需求
   - 計算總需求
   - 計算淨需求

4. **派貨建議階段**：
   - 應用MOQ規則
   - 計算建議派貨量
   - 確定派貨類型

5. **報告生成階段**：
   - 生成詳細計算報告
   - 生成匯總報告
   - 識別缺貨警告

### 詳細計算公式

#### 1. 日銷售率 (Daily_Sales_Rate)
```
Daily_Sales_Rate = Last_Month_Sold_Qty_capped / DAYS_IN_MONTH_FOR_RATE
```
- `Last_Month_Sold_Qty_capped`：上月銷售量（上限為100,000）
- `DAYS_IN_MONTH_FOR_RATE`：預設為30天

#### 2. 有效目標覆蓋天數 (Effective_Target_Cover_Days)
```
如果 Promo_Target_Cover_Days > 0:
    Effective_Target_Cover_Days = Promo_Target_Cover_Days
否則:
    Effective_Target_Cover_Days = DEFAULT_TARGET_COVER_DAYS (預設7天)
```

#### 3. 基本需求 (Base_Demand)
```
Base_Demand = Daily_Sales_Rate × (Effective_Target_Cover_Days + Lead_Time)
```
- `Lead_Time`：前置時間，預設為0天，可通過參數調整（範圍：0-14天）

#### 4. 門市推廣需求 (Site_Promo_Demand)
```
如果 Is_Promo_SKU 為 True:
    Site_Promo_Demand = SKU_Target × Site_Target_%
否則:
    Site_Promo_Demand = 0
```
- `Is_Promo_SKU`：必須同時滿足SKU_Target > 0和Site_Target_% > 0
- `Site_Target_%`：根據Target_Type選擇對應的門市目標百分比

#### 5. 總需求 (Total_Demand)
```
Total_Demand = Base_Demand + Site_Promo_Demand
```

#### 6. 淨需求原始值 (Net_Demand_raw)
```
Net_Demand_raw = Total_Demand - (SaSa_Net_Stock + Pending_Received)
```

#### 7. 派貨淨需求 (Net_Demand_for_Dispatch)
```
如果 USE_NEGATIVE_NET_FOR_DISPATCH 為 True:
    Net_Demand_for_Dispatch = Net_Demand_raw
否則:
    Net_Demand_for_Dispatch = max(Net_Demand_raw, 0)
```

#### 8. 建議派貨量 (Suggested_Dispatch_Qty)
```
如果 RP_Type = DISPATCH_RP_TYPE ("RF") 且 Net_Demand_for_Dispatch > 0 且 MOQ > 0:
    Suggested_Dispatch_Qty = ceil(max(Net_Demand_for_Dispatch, MOQ) / MOQ) × MOQ
否則:
    Suggested_Dispatch_Qty = 0
```

#### 9. 建議DN量 (Suggested_DN_Qty)
```
如果 RP_Type = "ND" 且 Suggested_Dispatch_Qty > 0:
    如果 Promotion_Days > 4:
        Suggested_DN_Qty = round(min(Suggested_Dispatch_Qty, 50))
    否則:
        Suggested_DN_Qty = round(Suggested_Dispatch_Qty)
    
    # 確保結果為MOQ的倍數
    如果 MOQ > 0:
        Suggested_DN_Qty = ceil(Suggested_DN_Qty / MOQ) × MOQ
否則:
    Suggested_DN_Qty = 0
```

#### 9. 派貨類型 (Dispatch_Type)
```
如果 Site = "D001":
    Dispatch_Type = "D001"
否則如果 RP_Type = "ND":
    如果 Suggested_DN_Qty > 0:
        如果 Supply_source = 1 或 4:
            Dispatch_Type = "Buyer需要訂貨"
        否則如果 Supply_source = 2:
            Dispatch_Type = "需生成 DN"
        否則:
            Dispatch_Type = "ND"
    否則:
        Dispatch_Type = "無須補貨"
否則如果 Supply_source = 1 或 4:
    Dispatch_Type = "Buyer需要訂貨"
否則如果 Supply_source = 2:
    Dispatch_Type = "需生成 DN"
否則:
    Dispatch_Type = "N/A"
```

### 摘要報告計算

#### 1. 非DC門市匯總
按Group_No和Article分組，匯總以下指標：
- Total_Demand：總需求
- Total_Stock：總庫存
- Total_Pending：總在途貨品
- Total_Dispatch：總建議派貨量
- Total_Stock_Available = Total_Stock + Total_Pending
- Total_Suggested_DN_Qty：總建議DN量（僅ND站點）

#### 2. DC庫存信息
按Article匯總DC(D001)的庫存信息：
- D001_SaSa_Net_Stock：DC淨庫存
- D001_In_Quality_Insp：DC品檢中數量
- D001_Blocked：DC封鎖庫存
- D001_Pending_Received：DC在途貨品

#### 3. 庫存狀態判斷 (Inventory_Status)
基於Supply source和庫存情況判斷庫存狀態：

**當Supply source為2時：**
- 計算有效庫存 = D001 SaSa_Net_Stock + Shop(H字頭) SaSa_Net_Stock + Shop(H字頭) Pending_Received
- 如果 Total_Demand > 有效庫存 且 D001 SaSa_Net_Stock > 100件：庫存足夠，RP team會安排Lot For Lot
- 如果 Total_Demand > 有效庫存 但 D001 SaSa_Net_Stock < 100件：庫存足夠目標數量，但D001少於100件，在需要時進行搓貨
- 如果 Total_Demand < 有效庫存：庫存不足夠，請Buyer留意

**當Supply source為1或4時：**
- 如果 Total_Demand > 有效庫存：庫存足夠
- 如果 Total_Demand < 有效庫存：庫存不足夠，請Buyer開PO

#### 4. 庫存差額 (Inventory_Difference)
```
Inventory_Difference = 有效庫存 - Total_Demand
```
- 正數表示庫存有餘量
- 負數表示庫存不足（在Excel中會以黃格紅字粗體顯示）

---

## 輸入文件格式和要求

### File A - 庫存數據文件

#### 文件要求
- **文件名**：Promotion Target File A.XLSX（可自定義）
- **格式**：Excel文件(.xlsx)
- **工作表**：必須包含名為"Data"的工作表

#### 必需列
| 列名 | 類型 | 說明 |
|------|------|------|
| Article | 文本 | 產品編碼 |
| Site | 文本 | 門市代碼（將自動轉換為大寫） |
| RP Type | 文本 | 補貨類型（如RF、ND等） |
| SaSa Net Stock | 數字 | 淨庫存數量 |
| Pending Received | 數字 | 在途貨品數量 |
| Safety Stock | 數字 | 安全庫存數量 |
| Last Month Sold Qty | 數字 | 上月銷售數量 |
| MOQ | 數字 | 最小訂購量 |
| Supply source | 數字 | 供應來源代碼 |

#### 可選列
| 列名 | 類型 | 說明 | 預設值 |
|------|------|------|--------|
| In Quality Insp. | 數字 | 品檢中數量 | 0 |
| Blocked | 數字 | 封鎖庫存數量 | 0 |

#### 數據處理規則
- Article和Site將自動去除前後空格
- Site代碼將自動轉換為大寫
- 所有數值列將轉換為數字，錯誤值設為0
- 負數值將被設為0並記錄警告
- Last Month Sold Qty超過100,000的值將被截斷為100,000
- 重複的(Article, Site)組合將被合併，數值欄位求和

### File B - 推廣目標文件

#### 文件要求
- **文件名**：Promotion Target File B.xlsx（可自定義）
- **格式**：Excel文件(.xlsx)
- **工作表**：必須包含兩個工作表："Sheet 1"和"Sheet 2"

#### Sheet 1 - 推廣SKU列表

##### 必需列
| 列名 | 類型 | 說明 |
|------|------|------|
| Group No. | 文本 | 推廣組別編號 |
| Article | 文本 | 產品編碼 |
| SKU Target | 數字 | SKU目標數量 |

##### 可選列
| 列名 | 類型 | 說明 | 預設值 |
|------|------|------|--------|
| Target Type | 文本 | 目標類型(HK/MO/ALL) | "ALL" |
| Target Cover Days | 數字 | 目標覆蓋天數 | 0（使用預設值7天） |

#### Sheet 2 - 門市目標百分比

##### 必需列
| 列名 | 類型 | 說明 |
|------|------|------|
| Site | 文本 | 門市代碼（將自動轉換為大寫） |
| Shop Target(HK) | 數字 | 香港門市目標百分比 |
| Shop Target(MO) | 數字 | 澳門門市目標百分比 |
| Shop Target(ALL) | 數字 | 所有門市目標百分比 |

##### 數據處理規則
- Site代碼將自動去除前後空格並轉換為大寫
- 百分比列可接受0-1或0-100的格式，>1的值將除以100轉換為百分比
- 缺失值將設為0

---

## 使用方法和操作流程

### 系統提供兩種使用方式

#### 1. 命令行界面 (CLI)

##### 基本使用
```bash
python promo_calculator.py
```
使用預設文件名和參數：
- File A: "Promotion Target File A.XLSX"
- File B: "Promotion Target File B.xlsx"
- Lead Time: 0天
- 輸出文件: "Promotion_Planning_Result.xlsx"

##### 自定義參數
```bash
python promo_calculator.py "FileA.xlsx" "FileB.xlsx" 10 "Result.xlsx"
```
參數說明：
1. File A路徑
2. File B路徑
3. Lead Time天數（可選，預設為0，範圍0-14）
4. 輸出文件名（可選，預設為"Promotion_Planning_Result.xlsx"）

##### 輸出說明
- 命令行會顯示所有數據質量警告
- 完成後顯示輸出文件路徑

#### 2. Web界面 (Streamlit)

##### 啟動系統
```bash
streamlit run streamlit_app.py
```
系統將在瀏覽器中打開Web界面

##### 操作步驟
1. **準備文件**：確保File A和File B符合格式要求
2. **上傳文件**：
   - 在左側面板上傳File A（庫存數據）
   - 上傳File B（推廣目標數據）
3. **設置參數**：
   - 使用滑塊調整Lead Time（前置時間）
   - 查看文件要求說明（可展開查看）
4. **執行分析**：
   - 點擊「開始分析 / Run Analysis」按鈕
   - 系統將顯示處理進度
5. **查看結果**：
   - **Detail Calculation**：查看詳細計算結果
   - **Summary Report**：查看匯總報告
   - **Visualizations**：查看圖表分析
6. **下載報告**：
   - 點擊「下載 Excel 報告」按鈕
   - 保存生成的Excel報告

##### Web界面特點
- 實時數據驗證和警告提示
- 交互式參數調整
- 多維度數據展示
- 圖表可視化分析
- 即時Excel報告生成和下載

---

## 輸出結果說明

### Excel報告結構
系統生成的Excel報告包含以下工作表：

#### 1. Final Order Report
包含原始File A數據加上計算結果：
- 所有File A的原始列
- Suggested_Dispatch_Qty：建議派貨量
- Dispatch_Type：派貨類型
- SKU_Target：SKU目標
- Site_Target_%：門市目標百分比
- Total_Demand：總需求

#### 2. Promo_Sheet1
File B Sheet 1的原始數據，供參考

#### 3. Promo_Sheet2
File B Sheet 2的原始數據，供參考

#### 4. Detail_Calculation
詳細計算結果，包含以下關鍵列：
- Group_No：推廣組別
- Article：產品編碼
- Site：門市代碼
- RP_Type：補貨類型
- SaSa_Net_Stock：淨庫存
- Pending_Received：在途貨品
- Safety_Stock：安全庫存
- SKU_Target：SKU目標
- Site_Target_%：門市目標百分比
- Is_Promo_SKU：是否為推廣SKU
- Total_Demand：總需求
- Suggested_Dispatch_Qty：建議派貨量
- Suggested_DN_Qty：建議DN量（僅ND站點）
- Promotion_Days：推廣天數
- Dispatch_Type：派貨類型

#### 5. Summary_Report
按Group_No和Article匯總的報告：
- Group_No：推廣組別
- Article：產品編碼
- Total_Demand：總需求
- Total_Stock_Available：總可用庫存
- Total_Stock：總庫存
- Total_Pending：總在途貨品
- Total_Dispatch：總建議派貨量
- D001_SaSa_Net_Stock：DC淨庫存
- New_SKU_Alert：新SKU提示（Launch Date為空白且Suggested_DN_Qty>0時顯示"新SKU必須由Buyer首次派貨"）
- Out_of_Stock_Warning：缺貨警告

### 關鍵結果解釋

#### Dispatch_Type（派貨類型）
- **D001**：DC門市，特殊處理
- **ND**：無需派貨（RP Type為ND且Suggested_DN_Qty=0）
- **無須補貨**：ND站點且Suggested_DN_Qty為0，無需補貨
- **新SKU必須由Buyer首次派貨**：Launch Date為空白且Suggested_DN_Qty>0的新SKU
- **Buyer需要訂貨**：供應來源為1或4，需要採購人員訂貨
- **需生成 DN**：供應來源為2且Suggested_DN_Qty>0，需要生成配送通知
- **N/A**：其他情況，無特殊操作

#### Out_of_Stock_Warning（缺貨警告）
- **D001 缺貨**：建議派貨量大於DC庫存，DC會缺貨
- **Y**：總需求大於總可用庫存，存在缺貨風險
- **N**：庫存充足，無缺貨風險

#### Is_Promo_SKU（推廣SKU標識）
- True：該SKU在推廣活動中，且該門市有目標百分比
- False：非推廣SKU或該門市無目標

### Web界面展示

#### Detail Calculation標籤
顯示完整的計算過程，包括：
- 基礎數據（庫存、銷售等）
- 中間計算結果（日銷售率、基本需求等）
- 最終結果（總需求、建議派貨量等）

#### Summary Report標籤
顯示按Group_No和Article匯總的報告，便於查看整體情況

#### Visualizations標籤
提供兩種圖表：
1. **SKU需求vs可用庫存柱狀圖**：比較各產品的總需求和可用庫存
2. **淨需求熱力圖**：顯示各產品在各門市的淨需求分布

---

## 配置選項和參數說明

### Config類參數

#### 計算常數
| 參數名 | 預設值 | 說明 |
|--------|--------|------|
| DAYS_IN_MONTH_FOR_RATE | 30 | 用於計算日銷售率的每月天數 |
| DEFAULT_TARGET_COVER_DAYS | 7 | 預設目標覆蓋天數 |
| DEFAULT_LEAD_TIME | 0 | 預設前置時間（天） |
| LAST_MONTH_SOLD_CAP | 100000 | 上月銷售量的上限值 |

#### 計算規則
| 參數名 | 預設值 | 說明 |
|--------|--------|------|
| USE_NEGATIVE_NET_FOR_DISPATCH | False | 是否允許負的淨需求用於派貨計算 |
| MISSING_MOQ_POLICY | "zero" | MOQ缺失/無效時的處理策略（"zero"或"one"） |
| DISPATCH_RP_TYPE | "RF" | 需要計算派貨的RP類型 |

#### 系統常數
| 參數名 | 預設值 | 說明 |
|--------|--------|------|
| DC_SITE_CODE | "D001" | DC門市的代碼 |

#### 文件列名映射
Config類中定義了所有輸入文件的列名映射，便於維護和修改：

##### File A列名
- COL_A_ARTICLE = "Article"
- COL_A_SITE = "Site"
- COL_A_RP_TYPE = "RP Type"
- COL_A_NET_STOCK = "SaSa Net Stock"
- COL_A_PENDING = "Pending Received"
- COL_A_SAFETY = "Safety Stock"
- COL_A_LAST_MONTH_SOLD = "Last Month Sold Qty"
- COL_A_MOQ = "MOQ"
- COL_A_SUPPLY_SOURCE = "Supply source"
- COL_A_IN_QLTY = "In Quality Insp."
- COL_A_BLOCKED = "Blocked"

##### File B Sheet 1列名
- COL_B1_GROUP_NO = "Group No."
- COL_B1_ARTICLE = "Article"
- COL_B1_SKU_TARGET = "SKU Target"
- COL_B1_TARGET_TYPE = "Target Type"
- COL_B1_PROMO_DAYS = "Promotion Days"
- COL_B1_TARGET_COVER_DAYS = "Target Cover Days"

##### File B Sheet 2列名
- COL_B2_SITE = "Site"
- COL_B2_HK = "Shop Target(HK)"
- COL_B2_MO = "Shop Target(MO)"
- COL_B2_ALL = "Shop Target(ALL)"

### Web界面參數

#### Lead Time滑塊
- 範圍：0-14天
- 預設值：0天
- 說明：影響基本需求的計算，值越大需求越大

### 命令行參數

#### 基本語法
```bash
python promo_calculator.py [file_a] [file_b] [lead_time] [output]
```

#### 參數說明
- file_a：File A路徑（可選，預設為"Promotion Target File A.XLSX"）
- file_b：File B路徑（可選，預設為"Promotion Target File B.xlsx"）
- lead_time：前置時間天數（可選，預設為0，範圍0-14）
- output：輸出文件路徑（可選，預設為"Promotion_Planning_Result.xlsx"）

---

## 常見問題和故障排除

### 數據相關問題

#### Q1: 出現"File A missing required columns"錯誤
**原因**：File A缺少必需的列
**解決方案**：
1. 檢查File A是否包含所有必需列（參見[輸入文件格式和要求](#輸入文件格式和要求)）
2. 確認列名拼寫正確，包括空格和大小寫
3. 確保數據在名為"Data"的工作表中

#### Q2: 出現"File B Sheet1 missing required columns"錯誤
**原因**：File B的Sheet 1缺少必需的列
**解決方案**：
1. 檢查File B是否包含Sheet 1和Sheet 2兩個工作表
2. 確認Sheet 1包含所有必需列
3. 檢查列名拼寫，包括空格和大小寫

#### Q3: 出現"NO Articles from File A matched with File B Sheet1"警告
**原因**：File A和File B的Article欄位沒有匹配項
**解決方案**：
1. 檢查兩個文件中的Article欄位是否有相同的值
2. 確認Article欄位沒有額外的空格或特殊字符
3. 檢查是否有數字格式不一致（如一個是文本，一個是數字）

#### Q4: 計算結果中所有Suggested_Dispatch_Qty都是0
**可能原因**：
1. RP_Type不是"RF"
2. Net_Demand_for_Dispatch為0或負數
3. MOQ為0或無效

**解決方案**：
1. 檢查RP_Type列是否包含"RF"值
2. 檢查庫存和需求計算是否合理
3. 確認MOQ列包含有效值

### 計算相關問題

#### Q5: 為什麼有些行的Net_Demand_for_Dispatch是0，但Net_Demand_raw是正數？
**原因**：系統預設不使用負的淨需求進行派貨計算
**解決方案**：
1. 這是正常行為，系統將負需求設為0
2. 如需使用負值，可修改Config中的USE_NEGATIVE_NET_FOR_DISPATCH為True

#### Q6: Out_of_Stock_Warning顯示"D001 缺貨"是什麼意思？
**原因**：建議派貨量大於DC的可用庫存
**解決方案**：
1. 檢查DC庫存數據是否正確
2. 考慮調整派貨優先級
3. 可能需要緊急補貨

### 系統運行問題

#### Q7: Streamlit無法啟動
**可能原因**：
1. 未安裝streamlit
2. Python環境問題

**解決方案**：
1. 安裝依賴：`pip install -r requirements.txt`
2. 確認Python版本兼容性
3. 檢查是否有防火牆阻止

#### Q8: Excel報告無法打開或損壞
**可能原因**：
1. 文件生成過程中被中斷
2. 磁碟空間不足

**解決方案**：
1. 確保計算完成後再下載文件
2. 檢查磁碟空間
3. 重新生成報告

#### Q9: 計算速度很慢
**可能原因**：
1. 數據量過大
2. 系統資源不足

**解決方案**：
1. 優化輸入數據，移除不必要的行和列
2. 確保系統有足夠的內存
3. 考慮分批處理大量數據

### 界面使用問題

#### Q10: Web界面顯示"Error during processing"
**解決方案**：
1. 檢查瀏覽器控制台的詳細錯誤信息
2. 確認輸入文件格式正確
3. 檢查系統日誌獲取更多錯誤詳情

#### Q11: 圖表不顯示或顯示異常
**可能原因**：
1. 數據格式問題
2. 沒有非D001的數據

**解決方案**：
1. 檢查數據中是否包含非D001的門市
2. 確認數值列沒有異常值
3. 嘗試刷新頁面重新加載

### 數據質量建議

#### 提高計算準確性的建議
1. **定期更新庫存數據**：確保庫存數據的準確性和時效性
2. **驗證銷售數據**：檢查上月銷售數據是否異常
3. **檢查MOQ設置**：確保MOQ設置合理，避免過高或過低
4. **確認供應來源**：檢查Supply_source設置是否正確
5. **驗證推廣目標**：確保推廣目標設置合理

#### 數據準備最佳實踐
1. **統一編碼格式**：確保所有文本使用相同的編碼
2. **去除多餘空格**：在導入前清理數據中的多餘空格
3. **標準化數值格式**：確保數值列使用一致的格式
4. **驗證數據完整性**：在導入前檢查數據是否完整
5. **備份原始數據**：保留原始數據副本以供參考

---

## 版本歷史和更新

### 當前版本特性
- 支持Excel文件輸入和輸出
- 提供命令行和Web兩種界面
- 完整的需求計算和派貨規劃功能
- 多維度報告和可視化分析
- 靈活的配置選項
- 基於Supply source和庫存情況的智能庫存狀態判斷
- ND站點的Suggested_DN_Qty計算，考慮Promotion Days和MOQ
- 自動將Article欄位轉換為TEXT格式
- 負數庫存差額的黃格紅字粗體顯示
- 優化的Dispatch_Type邏輯，包括"無須補貨"狀態

### 最新更新 (2025年12月)
1. **優化庫存狀態邏輯**：
   - 當Supply source為2時，基於有效庫存和D001庫存判斷庫存狀態
   - 當Supply source為1或4時，基於有效庫存判斷庫存狀態
2. **改進Dispatch_Type邏輯**：
   - ND站點當Suggested_DN_Qty為0時顯示"無須補貨"
   - 將"開PO"改為"Buyer需要訂貨"
   - **新增新SKU邏輯**：當Launch Date為空白且Suggested_DN_Qty>0時，顯示"新SKU必須由Buyer首次派貨"
3. **優化Suggested_DN_Qty計算**：
   - 當Promotion Days > 4時，上限為50件
   - 確保結果仍為MOQ的倍數
   - 結果四捨五入至整數
4. **增強報告功能**：
   - 新增Total_Suggested_DN_Qty欄位
   - 新增Inventory_Difference欄位，並對負數應用特殊格式
   - **新增New_SKU_Alert欄位**：在Summary_Report中為新SKU添加提示
5. **改進用戶界面**：
   - 優化欄位順序
   - 增強可視化效果
6. **新增Launch Date欄位支援**：
   - 在File A中支援Launch Date欄位處理
   - 空白或空值的Launch Date會被識別為新SKU

### 未來改進方向
1. 支持更多文件格式（CSV等）
2. 增加更多可視化圖表類型
3. 優化大數據量處理性能
4. 增加數據驗證和清洗工具
5. 支持多種語言界面

---

## 聯繫和支持

如有技術問題或建議，請聯繫系統管理員或開發團隊。

---

*本文檔最後更新時間：2025年12月*